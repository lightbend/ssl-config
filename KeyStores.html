<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Configuring Trust Stores and Key Stores &mdash; ssl-config documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="ssl-config documentation" href="index.html" />
    <link rel="next" title="Configuring Protocols" href="Protocols.html" />
    <link rel="prev" title="Generating X.509 Certificates" href="CertificateGeneration.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#configuring-trust-stores-and-key-stores" id="id1">Configuring Trust Stores and Key Stores</a><ul>
<li><a class="reference internal" href="#configuring-a-trust-manager" id="id2">Configuring a Trust Manager</a></li>
<li><a class="reference internal" href="#configuring-a-key-manager" id="id3">Configuring a Key Manager</a></li>
<li><a class="reference internal" href="#configuring-a-store" id="id4">Configuring a Store</a></li>
<li><a class="reference internal" href="#debugging" id="id5">Debugging</a></li>
<li><a class="reference internal" href="#further-reading" id="id6">Further Reading</a></li>
</ul>
</li>
</ul>
</div>
<!--- Copyright (C) 2009-2015 Typesafe Inc. <http://www.typesafe.com> --><div class="section" id="configuring-trust-stores-and-key-stores">
<span id="keystores"></span><h1><a class="toc-backref" href="#id1">Configuring Trust Stores and Key Stores</a><a class="headerlink" href="#configuring-trust-stores-and-key-stores" title="Permalink to this headline">¶</a></h1>
<p>Trust stores and key stores contain X.509 certificates. Those
certificates contain public (or private) keys, and are organized and
managed under either a TrustManager or a KeyManager, respectively.</p>
<p>If you need to generate X.509 certificates, please see <a class="reference internal" href="CertificateGeneration.html#certificategeneration"><em>Certificate Generation</em></a> for more information.</p>
<div class="section" id="configuring-a-trust-manager">
<h2><a class="toc-backref" href="#id2">Configuring a Trust Manager</a><a class="headerlink" href="#configuring-a-trust-manager" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference external" href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#TrustManager">trust
manager</a>
is used to keep trust anchors: these are root certificates which have
been issued by certificate authorities. It determines whether the remote
authentication credentials (and thus the connection) should be trusted.
As an HTTPS client, the vast majority of requests will use only a trust
manager.</p>
<p>If you do not configure it at all, WS uses the default trust manager,
which points to the <tt class="docutils literal"><span class="pre">cacerts</span></tt> key store in
<tt class="docutils literal"><span class="pre">${java.home}/lib/security/cacerts</span></tt>. If you configure a trust manager
explicitly, it will override the default settings and the <tt class="docutils literal"><span class="pre">cacerts</span></tt>
store will not be included.</p>
<p>If you wish to use the default trust store and add another store
containing certificates, you can define multiple stores in your trust
manager. The
<a class="reference external" href="api/scala/play/api/libs/ws/ssl/CompositeX509TrustManager.html">CompositeX509TrustManager</a>
will try each in order until it finds a match:</p>
<div class="highlight-python"><div class="highlight"><pre>ssl-config.ssl {
  trustManager = {
      stores = [
        { path: ${store.directory}/truststore.jks, type: &quot;JKS&quot; }  # Added trust store
        { path: ${java.home}/lib/security/cacerts, password = &quot;changeit&quot; } # Default trust store
      ]
  }
}
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Trust stores should only contain CA certificates with
public keys, usually JKS or PEM. PKCS12 format is supported, but
PKCS12 should not contain private keys in a trust store, as noted in
the <a class="reference external" href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#SunJSSE">reference
guide</a>.</p>
</div>
</div>
<div class="section" id="configuring-a-key-manager">
<h2><a class="toc-backref" href="#id3">Configuring a Key Manager</a><a class="headerlink" href="#configuring-a-key-manager" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference external" href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#KeyManager">key
manager</a>
is used to present keys for a remote host. Key managers are typically
only used for client authentication (also known as mutual TLS).</p>
<p>The
<a class="reference external" href="api/scala/play/api/libs/ws/ssl/CompositeX509KeyManager.html">CompositeX509KeyManager</a>
may contain multiple stores in the same manner as the trust manager.</p>
<div class="highlight-python"><div class="highlight"><pre>ssl-config.ssl {
    keyManager = {
      stores = [
        {
          type: &quot;pkcs12&quot;,
          path: &quot;keystore.p12&quot;,
          password: &quot;password1&quot;
        },
      ]
    }
}
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A key store that holds private keys should use PKCS12
format, as indicated in the <a class="reference external" href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#SunJSSE">reference
guide</a>.</p>
</div>
</div>
<div class="section" id="configuring-a-store">
<h2><a class="toc-backref" href="#id4">Configuring a Store</a><a class="headerlink" href="#configuring-a-store" title="Permalink to this headline">¶</a></h2>
<p>A store corresponds to a
<a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyStore.html">KeyStore</a>
object, which is used for both trust stores and key stores. Stores may
have a
<a class="reference external" href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/StandardNames.html#KeyStore">type</a>
&#8211; <tt class="docutils literal"><span class="pre">PKCS12</span></tt>,
<tt class="docutils literal"><span class="pre">`JKS</span></tt> &lt;<a class="reference external" href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec.html#KeystoreImplementation">https://docs.oracle.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec.html#KeystoreImplementation</a>&gt;`__
or <tt class="docutils literal"><span class="pre">PEM</span></tt> (aka Base64 encoded DER certificate) &#8211; and may have an
associated password.</p>
<p>Stores must have either a <tt class="docutils literal"><span class="pre">path</span></tt> or a <tt class="docutils literal"><span class="pre">data</span></tt> attribute. The <tt class="docutils literal"><span class="pre">path</span></tt>
attribute must be a file system path.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span> <span class="nb">type</span><span class="p">:</span> <span class="s">&quot;PKCS12&quot;</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="s">&quot;/private/keystore.p12&quot;</span> <span class="p">}</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">data</span></tt> attribute must contain a string of PEM encoded
certificates.</p>
<div class="highlight-python"><div class="highlight"><pre>{
  type: &quot;PEM&quot;, data = &quot;&quot;&quot;
-----BEGIN CERTIFICATE-----
...certificate data
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
...certificate data
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
...certificate data
-----END CERTIFICATE-----
&quot;&quot;&quot;
}
</pre></div>
</div>
</div>
<div class="section" id="debugging">
<h2><a class="toc-backref" href="#id5">Debugging</a><a class="headerlink" href="#debugging" title="Permalink to this headline">¶</a></h2>
<p>To debug the key manager / trust manager, set the following flags:</p>
<div class="highlight-python"><div class="highlight"><pre>ssl-config.ssl.debug = {
  ssl = true
  trustmanager = true
  keymanager = true
}
</pre></div>
</div>
</div>
<div class="section" id="further-reading">
<h2><a class="toc-backref" href="#id6">Further Reading</a><a class="headerlink" href="#further-reading" title="Permalink to this headline">¶</a></h2>
<p>In most cases, you will not need to do extensive configuration once the
certificates are installed. If you are having difficulty with
configuration, the following blog posts may be useful:</p>
<ul class="simple">
<li><a class="reference external" href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec.html#KeyManagement">Key
Management</a></li>
<li><a class="reference external" href="http://blog.palominolabs.com/2011/10/18/java-2-way-tlsssl-client-certificates-and-pkcs12-vs-jks-keystores/">Java 2-way TLS/SSL (Client Certificates) and PKCS12 vs JKS
KeyStores</a></li>
<li><a class="reference external" href="http://chariotsolutions.com/blog/post/https-with-client-certificates-on/">HTTPS with Client Certificates on
Android</a></li>
</ul>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Configuring Trust Stores and Key Stores</a><ul>
<li><a class="reference internal" href="#configuring-a-trust-manager">Configuring a Trust Manager</a></li>
<li><a class="reference internal" href="#configuring-a-key-manager">Configuring a Key Manager</a></li>
<li><a class="reference internal" href="#configuring-a-store">Configuring a Store</a></li>
<li><a class="reference internal" href="#debugging">Debugging</a></li>
<li><a class="reference internal" href="#further-reading">Further Reading</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="CertificateGeneration.html" title="previous chapter">Generating X.509 Certificates</a></li>
      <li>Next: <a href="Protocols.html" title="next chapter">Configuring Protocols</a></li>
  </ul></li>
</ul>
</div>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/KeyStores.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, Typesafe.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.2.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster </a>
      
      |
      <a href="_sources/KeyStores.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>