<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
<title>Configuring Trust Stores and Key Stores · SSL Config</title>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<meta name="description" content='documentation'/>
<link href="https://fonts.googleapis.com/css?family=Roboto:100normal,100italic,300normal,300italic,400normal,400italic,500normal,500italic,700normal,700italic,900normal,900italicc" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="lib/jquery/jquery.min.js"></script>
<script type="text/javascript" src="js/page.js"></script>
<script type="text/javascript" src="js/groups.js"></script>
<link rel="stylesheet" type="text/css" href="lib/normalize.css/normalize.css"/>
<link rel="stylesheet" type="text/css" href="lib/foundation/dist/foundation.min.css"/>
<link rel="stylesheet" type="text/css" href="css/page.css"/>

<!--
<link rel="shortcut icon" href="images/favicon.ico" />
-->
</head>

<body>
<div class="off-canvas-wrapper">
<div class="off-canvas-wrapper-inner" data-off-canvas-wrapper>

<div class="off-canvas position-left" id="off-canvas-menu" data-off-canvas>
<nav class="off-canvas-nav">
<div class="nav-home">
<a href="index.html" >
<span class="home-icon">⌂</span>SSL Config
</a>
<div class="version-number">
0.3.7*
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="WSQuickStart.html" class="page">Quick Start to WS SSL</a></li>
  <li><a href="CertificateGeneration.html" class="page">Generating X.509 Certificates</a></li>
  <li><a href="KeyStores.html" class="active page">Configuring Trust Stores and Key Stores</a></li>
  <li><a href="Protocols.html" class="page">Configuring Protocols</a></li>
  <li><a href="CipherSuites.html" class="page">Configuring Cipher Suites</a></li>
  <li><a href="CertificateRevocation.html" class="page">Configuring Certificate Revocation</a></li>
  <li><a href="HostnameVerification.html" class="page">Hostname Verification</a></li>
  <li><a href="CertificateValidation.html" class="page">Configuring Certificate Validation</a></li>
  <li><a href="ExampleSSLConfig.html" class="page">Example Configurations</a></li>
  <li><a href="DefaultContext.html" class="page">Using the Default SSLContext</a></li>
  <li><a href="DebuggingSSL.html" class="page">Debugging SSL Connections</a></li>
  <li><a href="LooseSSL.html" class="page">Loose Options</a></li>
  <li><a href="TestingSSL.html" class="page">Testing SSL</a></li>
</ul>
</div>

</nav>
</div>

<div class="off-canvas-content" data-off-canvas-content>

<header class="site-header expanded row">
<div class="small-12 column">
<a href="#" class="off-canvas-toggle hide-for-medium" data-toggle="off-canvas-menu"><svg class="svg-icon svg-icon-menu" version="1.1" id="Menu" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve"> <path class="svg-icon-menu-path" fill="#53CDEC" d="M16.4,9H3.6C3.048,9,3,9.447,3,10c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,9.447,16.952,9,16.4,9z M16.4,13
H3.6C3.048,13,3,13.447,3,14c0,0.553,0.048,1,0.6,1H16.4c0.552,0,0.6-0.447,0.6-1C17,13.447,16.952,13,16.4,13z M3.6,7H16.4
C16.952,7,17,6.553,17,6c0-0.553-0.048-1-0.6-1H3.6C3.048,5,3,5.447,3,6C3,6.553,3.048,7,3.6,7z"/></svg>
</a>
<div class="title"><a href="index.html">SSL Config</a></div>

<!--
<a href="https://www.example.com" class="logo show-for-medium">logo</a>
-->
</div>
</header>

<div class="expanded row">

<div class="medium-3 large-2 show-for-medium column">
<nav class="site-nav">
<div class="nav-home">
<a href="index.html" >
<span class="home-icon">⌂</span>SSL Config
</a>
<div class="version-number">
0.3.7*
</div>
</div>
<div class="nav-toc">
<ul>
  <li><a href="WSQuickStart.html" class="page">Quick Start to WS SSL</a></li>
  <li><a href="CertificateGeneration.html" class="page">Generating X.509 Certificates</a></li>
  <li><a href="KeyStores.html" class="active page">Configuring Trust Stores and Key Stores</a></li>
  <li><a href="Protocols.html" class="page">Configuring Protocols</a></li>
  <li><a href="CipherSuites.html" class="page">Configuring Cipher Suites</a></li>
  <li><a href="CertificateRevocation.html" class="page">Configuring Certificate Revocation</a></li>
  <li><a href="HostnameVerification.html" class="page">Hostname Verification</a></li>
  <li><a href="CertificateValidation.html" class="page">Configuring Certificate Validation</a></li>
  <li><a href="ExampleSSLConfig.html" class="page">Example Configurations</a></li>
  <li><a href="DefaultContext.html" class="page">Using the Default SSLContext</a></li>
  <li><a href="DebuggingSSL.html" class="page">Debugging SSL Connections</a></li>
  <li><a href="LooseSSL.html" class="page">Loose Options</a></li>
  <li><a href="TestingSSL.html" class="page">Testing SSL</a></li>
</ul>
</div>

</nav>
</div>

<div class="small-12 medium-9 large-10 column">
<section class="site-content">

<div class="page-header row">
<div class="medium-12 show-for-medium column">
<div class="nav-breadcrumbs">
<ul>
  <li><a href="index.html">SSL Config</a></li>
  <li>Configuring Trust Stores and Key Stores</li>
</ul>
</div>
</div>
</div>

<div class="page-content row">
<div class="small-12 large-9 column" id="docs">
<h1><a href="#configuring-trust-stores-and-key-stores" name="configuring-trust-stores-and-key-stores" class="anchor"><span class="anchor-link"></span></a>Configuring Trust Stores and Key Stores</h1>
<p>Trust stores and key stores contain X.509 certificates. Those certificates contain public (or private) keys, and are organized and managed under either a TrustManager or a KeyManager, respectively.</p>
<p>If you need to generate X.509 certificates, please see <a href="CertificateGeneration.html">Certificate Generation</a> for more information.</p>
<h2><a href="#configuring-a-trust-manager" name="configuring-a-trust-manager" class="anchor"><span class="anchor-link"></span></a>Configuring a Trust Manager</h2>
<p>A <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#TrustManager">trust manager</a> is used to keep trust anchors: these are root certificates which have been issued by certificate authorities. It determines whether the remote authentication credentials (and thus the connection) should be trusted. As an HTTPS client, the vast majority of requests will use only a trust manager.</p>
<p>If you do not configure it at all, WS uses the default trust manager, which points to the <code>cacerts</code> key store in <code>${java.home}/lib/security/cacerts</code>. If you configure a trust manager explicitly, it will override the default settings and the <code>cacerts</code> store will not be included.</p>
<p>If you wish to use the default trust store and add another store containing certificates, you can define multiple stores in your trust manager. The <a href="api/scala/play/api/libs/ws/ssl/CompositeX509TrustManager.html">CompositeX509TrustManager</a> will try each in order until it finds a match:</p>
<pre class="prettyprint"><code class="language-conf">ssl-config {
  trustManager = {
    stores = [
      { path: ${store.directory}/truststore.jks, type: &quot;JKS&quot; }  # Added trust store
      { path: ${java.home}/lib/security/cacerts, password = &quot;changeit&quot; } # Default trust store
    ]
  }
}
</code></pre><div class="callout note "><div class="callout-title">Note</div>
<p>Trust stores should only contain CA certificates with public keys, usually JKS or PEM. PKCS12 format is supported, but PKCS12 should not contain private keys in a trust store, as noted in the <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#SunJSSE">reference guide</a>.</p></div>
<h2><a href="#configuring-a-key-manager" name="configuring-a-key-manager" class="anchor"><span class="anchor-link"></span></a>Configuring a Key Manager</h2>
<p>A <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#KeyManager">key manager</a> is used to present keys for a remote host. Key managers are typically only used for client authentication (also known as mutual TLS).</p>
<p>The <a href="api/scala/play/api/libs/ws/ssl/CompositeX509KeyManager.html">CompositeX509KeyManager</a> may contain multiple stores in the same manner as the trust manager.</p>
<pre class="prettyprint"><code class="language-conf">ssl-config {
  keyManager = {
    stores = [
      {
        type: &quot;pkcs12&quot;,
        path: &quot;keystore.p12&quot;,
        password: &quot;password1&quot;
      },
    ]
  }
}
</code></pre><div class="callout note "><div class="callout-title">Note</div>
<p>A key store that holds private keys should use PKCS12 format, as indicated in the <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/jsse/JSSERefGuide.html#SunJSSE">reference guide</a>.</p></div>
<h2><a href="#configuring-a-store" name="configuring-a-store" class="anchor"><span class="anchor-link"></span></a>Configuring a Store</h2>
<p>A store corresponds to a <a href="https://docs.oracle.com/javase/8/docs/api/java/security/KeyStore.html">KeyStore</a> object, which is used for both trust stores and key stores. Stores may have a <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/StandardNames.html#KeyStore">type</a> &ndash; <code>PKCS12</code>, <a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec.html#KeystoreImplementation"><code>JKS</code></a> or <code>PEM</code> (aka Base64 encoded DER certificate) &ndash; and may have an associated password.</p>
<p>Stores must have either a <code>path</code> or a <code>data</code> attribute. The <code>path</code> attribute must be a file system path.</p>
<pre class="prettyprint"><code class="language-conf">{ type: &quot;PKCS12&quot;, path: &quot;/private/keystore.p12&quot; }
</code></pre>
<p>The <code>data</code> attribute must contain a string of PEM encoded certificates.</p>
<pre class="prettyprint"><code class="language-conf">{
  type: &quot;PEM&quot;, data = &quot;&quot;&quot;
-----BEGIN CERTIFICATE-----
...certificate data
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
...certificate data
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
...certificate data
-----END CERTIFICATE-----
&quot;&quot;&quot;
}
</code></pre>
<h2><a href="#debugging" name="debugging" class="anchor"><span class="anchor-link"></span></a>Debugging</h2>
<p>To debug the key manager / trust manager, set the following flags:</p>
<pre class="prettyprint"><code class="language-conf">ssl-config.debug = {
  ssl = true
  trustmanager = true
  keymanager = true
}
</code></pre>
<h2><a href="#further-reading" name="further-reading" class="anchor"><span class="anchor-link"></span></a>Further Reading</h2>
<p>In most cases, you will not need to do extensive configuration once the certificates are installed. If you are having difficulty with configuration, the following blog posts may be useful:</p>
<ul>
  <li><a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/crypto/CryptoSpec.html#KeyManagement">Key Management</a></li>
  <li><a href="http://blog.palominolabs.com/2011/10/18/java-2-way-tlsssl-client-certificates-and-pkcs12-vs-jks-keystores/">Java 2-way TLS/SSL (Client Certificates) and PKCS12 vs JKS KeyStores</a></li>
  <li><a href="http://chariotsolutions.com/blog/post/https-with-client-certificates-on/">HTTPS with Client Certificates on Android</a></li>
</ul>
<div class="nav-next">
<p><strong>Next:</strong> <a href="Protocols.html">Configuring Protocols</a></p>
</div>
</div>
<div class="large-3 show-for-large column" data-sticky-container>
<nav class="sidebar sticky" data-sticky data-anchor="docs" data-sticky-on="large">
<div class="page-nav">
<div class="nav-title">On this page:</div>
<div class="nav-toc">
<ul>
  <li><a href="KeyStores.html#configuring-trust-stores-and-key-stores" class="header">Configuring Trust Stores and Key Stores</a>
  <ul>
    <li><a href="KeyStores.html#configuring-a-trust-manager" class="header">Configuring a Trust Manager</a></li>
    <li><a href="KeyStores.html#configuring-a-key-manager" class="header">Configuring a Key Manager</a></li>
    <li><a href="KeyStores.html#configuring-a-store" class="header">Configuring a Store</a></li>
    <li><a href="KeyStores.html#debugging" class="header">Debugging</a></li>
    <li><a href="KeyStores.html#further-reading" class="header">Further Reading</a></li>
  </ul></li>
</ul>
</div>
</div>
</nav>
</div>
</div>

</section>
</div>

</div>

<footer class="site-footer">

<section class="site-footer-nav">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 medium-4 large-3 text-center column">
<div class="nav-links">
<ul>
<!-- <li><a href="https://www.example.com/products/">Products</a> -->
</ul>
</div>
</div>

</div>
</div>
</div>
</section>

<section class="site-footer-base">
<div class="expanded row">
<div class="small-12 large-offset-2 large-10 column">
<div class="row site-footer-content">

<div class="small-12 text-center large-9 column">

<!--
<div class="copyright">
<span class="text">&copy; 2018</span>
<a href="https://www.example.com" class="logo">logo</a>
</div>
-->
</div>

</div>
</div>
</div>
</section>
</footer>

</div>
</div>
</div>
</body>

<script type="text/javascript" src="lib/foundation/dist/foundation.min.js"></script>
<script type="text/javascript">jQuery(document).foundation();</script>
<script type="text/javascript" src="js/magellan.js"></script>

<style type="text/css">@import "lib/prettify/prettify.css";</style>
<script type="text/javascript" src="lib/prettify/prettify.js"></script>
<script type="text/javascript" src="lib/prettify/lang-scala.js"></script>
<script type="text/javascript">jQuery(function(){window.prettyPrint && prettyPrint()});</script>

</html>
